<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Perspective Engine - Aroha's Projects</title>

    <!-- Privacy-friendly analytics by Plausible -->
    <script async src="https://plausible.io/js/pa-YDHVJtiLBBWA8IRTBSaq6.js"></script>
    <script>
      window.plausible=window.plausible||function(){(plausible.q=plausible.q||[]).push(arguments)},plausible.init=plausible.init||function(i){plausible.o=i||{}};
      plausible.init()
    </script>
    <script src="/shared/analytics.js"></script>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* NOW Dot Pulse Animation */
        @keyframes pulse-now {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.9;
            }
        }

        .pulse-now {
            animation: pulse-now 2s ease-in-out infinite;
        }

        /* Death Sequence Animations */
        @keyframes die {
            to {
                background-color: rgb(75 85 99 / 0.6);
                box-shadow: none;
            }
        }

        @keyframes final-pulse {
            0%, 100% {
                transform: scale(1.5);
                opacity: 1;
            }
            50% {
                transform: scale(1.8);
                opacity: 0.7;
            }
        }

        /* Buddhism - Dissolve and Flow */
        @keyframes buddhist-dissolve {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            50% {
                opacity: 0.3;
                transform: translateY(10px) scale(0.5);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes nirvana-merge {
            to {
                opacity: 0;
                transform: scale(2);
                filter: blur(10px);
            }
        }

        /* Christianity - Heaven */
        @keyframes rise-to-heaven {
            to {
                transform: translateY(-300px);
                background-color: #fbbf24;
                box-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
            }
        }

        /* Christianity - Purgatory */
        @keyframes purgatory-purify {
            0%, 100% {
                background-color: rgb(75 85 99 / 0.6);
                filter: brightness(1);
            }
            50% {
                background-color: #ffffff;
                filter: brightness(2);
            }
        }

        /* Christianity - Hell */
        @keyframes descend-to-hell {
            to {
                transform: translateY(300px);
                background-color: #7f1d1d;
                box-shadow: 0 0 10px rgba(127, 29, 29, 0.8);
            }
        }

        /* Islam - Jannah */
        @keyframes barzakh-pause {
            0%, 50% {
                opacity: 0.5;
            }
            100% {
                opacity: 1;
            }
        }

        @keyframes rise-to-jannah {
            to {
                transform: translateY(-250px);
                background: linear-gradient(135deg, #10b981, #fbbf24);
                box-shadow: 0 0 15px rgba(16, 185, 129, 0.8);
            }
        }

        /* Islam - Jahannam */
        @keyframes descend-to-jahannam {
            to {
                transform: translateY(300px);
                background-color: #991b1b;
                box-shadow: 0 0 10px rgba(153, 27, 27, 0.8);
            }
        }

        /* Hinduism - Reincarnation */
        @keyframes reincarnate-scatter {
            0% {
                transform: translate(0, 0);
                opacity: 1;
            }
            50% {
                transform: translate(var(--scatter-x), var(--scatter-y));
                opacity: 0;
            }
            100% {
                transform: translate(var(--reborn-x), var(--reborn-y));
                opacity: 1;
            }
        }

        /* Hinduism - Moksha */
        @keyframes moksha-expand {
            to {
                transform: scale(3);
                opacity: 0;
                filter: blur(15px);
            }
        }

        /* Judaism - Rest */
        @keyframes judaic-rest {
            to {
                box-shadow: 0 0 8px rgba(251, 191, 36, 0.4);
                filter: brightness(1.2);
            }
        }

        /* Ancestor Traditions */
        @keyframes move-to-past {
            to {
                transform: translateZ(-100px) translateY(-20px);
                opacity: 0.4;
                filter: blur(2px);
            }
        }

        /* Analytic Idealism */
        @keyframes dissolve-boundaries {
            to {
                border-radius: 50%;
                opacity: 0.3;
                filter: blur(8px);
                box-shadow: 0 0 20px currentColor;
            }
        }

        /* Panpsychism */
        @keyframes fragment-consciousness {
            to {
                transform: translate(var(--fragment-x), var(--fragment-y)) scale(0.3);
                opacity: 0.7;
            }
        }

        /* Illusionism */
        @keyframes switch-off {
            0% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
                filter: blur(2px);
            }
            100% {
                opacity: 0;
            }
        }

        /* Simulation Theory */
        @keyframes glitch {
            0%, 100% {
                transform: translate(0, 0);
                opacity: 1;
            }
            20% {
                transform: translate(-2px, 2px);
                opacity: 0.8;
            }
            40% {
                transform: translate(2px, -2px);
                opacity: 0.6;
            }
            60% {
                transform: translate(-1px, -1px);
                opacity: 0.4;
            }
            80% {
                transform: translate(1px, 1px);
                opacity: 0.2;
            }
        }

        /* Atomic Dispersal */
        @keyframes atomic-drift {
            to {
                transform: translate(var(--drift-x), var(--drift-y));
                opacity: 0.8;
            }
        }

        /* Heat Death */
        @keyframes heat-death {
            to {
                background-color: rgb(55 65 81 / 0.3);
                opacity: 0.3;
                filter: blur(5px);
            }
        }

        /* Page Atmosphere Transitions */
        .atmosphere-buddhism {
            background: linear-gradient(to br, rgb(17, 24, 39), rgb(30, 58, 138), rgb(17, 24, 39)) !important;
        }

        .atmosphere-heaven {
            background: linear-gradient(to br, rgb(120, 53, 15), rgb(251, 191, 36), rgb(17, 24, 39)) !important;
        }

        .atmosphere-hell {
            background: linear-gradient(to br, rgb(0, 0, 0), rgb(127, 29, 29), rgb(0, 0, 0)) !important;
        }

        .atmosphere-jannah {
            background: linear-gradient(to br, rgb(6, 78, 59), rgb(16, 185, 129), rgb(17, 24, 39)) !important;
        }

        .atmosphere-jahannam {
            background: linear-gradient(to br, rgb(0, 0, 0), rgb(153, 27, 27), rgb(0, 0, 0)) !important;
        }

        .atmosphere-hinduism {
            background: linear-gradient(to br, rgb(124, 45, 18), rgb(251, 146, 60), rgb(17, 24, 39)) !important;
        }

        .atmosphere-judaism {
            background: linear-gradient(to br, rgb(17, 24, 39), rgb(55, 48, 41), rgb(17, 24, 39)) !important;
        }

        .atmosphere-ancestor {
            background: linear-gradient(to br, rgb(28, 25, 23), rgb(68, 64, 60), rgb(17, 24, 39)) !important;
        }

        .atmosphere-idealism {
            background: linear-gradient(to br, rgb(17, 24, 39), rgb(88, 28, 135), rgb(17, 24, 39)) !important;
            filter: blur(0.5px);
        }

        .atmosphere-panpsychism {
            background: linear-gradient(to br, rgb(17, 24, 39), rgb(30, 58, 138), rgb(17, 24, 39)) !important;
        }

        .atmosphere-illusionism {
            background: linear-gradient(to br, rgb(17, 24, 39), rgb(31, 41, 55), rgb(17, 24, 39)) !important;
        }

        .atmosphere-simulation {
            background: linear-gradient(to br, rgb(17, 24, 39), rgb(30, 41, 59), rgb(17, 24, 39)) !important;
        }

        .atmosphere-atomic {
            background: linear-gradient(to br, rgb(20, 33, 23), rgb(34, 51, 32), rgb(17, 24, 39)) !important;
        }

        .atmosphere-heatdeath {
            background: linear-gradient(to br, rgb(17, 24, 39), rgb(31, 41, 55), rgb(17, 24, 39)) !important;
            filter: brightness(0.7);
        }

        /* Modal Styles */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .modal-content {
            max-height: 90vh;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(156, 163, 175, 0.3) transparent;
        }

        .modal-content::-webkit-scrollbar {
            width: 8px;
        }

        .modal-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .modal-content::-webkit-scrollbar-thumb {
            background-color: rgba(156, 163, 175, 0.3);
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Simple SVG icons as React components
        const ClockIcon = () => (
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" strokeWidth="2"/>
                <path d="M12 6v6l4 2" strokeWidth="2" strokeLinecap="round"/>
            </svg>
        );

        const CalendarIcon = () => (
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <rect x="3" y="4" width="18" height="18" rx="2" strokeWidth="2"/>
                <path d="M16 2v4M8 2v4M3 10h18" strokeWidth="2"/>
            </svg>
        );

        const HeartIcon = () => (
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" strokeWidth="2"/>
            </svg>
        );

        const TrendingUpIcon = () => (
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M23 6l-9.5 9.5-5-5L1 18" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                <path d="M17 6h6v6" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            </svg>
        );

        const ZapIcon = () => (
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            </svg>
        );

        const InfoIcon = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" strokeWidth="2"/>
                <path d="M12 16v-4M12 8h.01" strokeWidth="2" strokeLinecap="round"/>
            </svg>
        );

        const SproutIcon = () => (
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M7 20h10M10 20c0-4.4 3.6-8 8-8h2M10 20c0-4.4-3.6-8-8-8H0" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                <path d="M12 20V10c0-4.4 3.6-8 8-8" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            </svg>
        );

        const PerspectiveEngine = () => {
          const [currentAge, setCurrentAge] = useState(30);
          const [goalAge, setGoalAge] = useState(85);
          const [quoteIndex, setQuoteIndex] = useState(0);

          // Afterlife feature state
          const [showAfterlife, setShowAfterlife] = useState(false);
          const [isDeathSequence, setIsDeathSequence] = useState(false);
          const [showWorldviewSelector, setShowWorldviewSelector] = useState(false);
          const [selectedWorldview, setSelectedWorldview] = useState(null);
          const [pageAtmosphere, setPageAtmosphere] = useState('');

          // Initialize analytics on component mount
          useEffect(() => {
            if (window.Analytics) {
              window.Analytics.init();
            }
          }, []);

          const quotes = [
            { text: "You could leave life right now. Let that determine what you do and say and think.", author: "Marcus Aurelius" },
            { text: "The trouble is, you think you have time.", author: "Buddha" },
            { text: "Time is the coin of your life. It is the only coin you have, and only you can determine how it will be spent.", author: "Carl Sandburg" },
            { text: "The days are long but the decades are short.", author: "Sam Altman" },
            { text: "We are always getting ready to live but never living.", author: "Ralph Waldo Emerson" },
            { text: "Do not act as if you had ten thousand years to live.", author: "Marcus Aurelius" }
          ];

          // Worldview data with descriptions and sources
          const worldviews = {
            buddhism: {
              name: 'Buddhism - Rebirth',
              description: 'Consciousness dissolves and reforms in a new existence based on karma.',
              source: 'https://plato.stanford.edu/entries/buddhism/',
              atmosphere: 'atmosphere-buddhism'
            },
            nirvana: {
              name: 'Buddhism - Nirvana',
              description: 'Liberation from the cycle of rebirth; merging with the ultimate reality.',
              source: 'https://plato.stanford.edu/entries/buddhism/',
              atmosphere: 'atmosphere-buddhism'
            },
            heaven: {
              name: 'Christianity - Heaven',
              description: 'Eternal communion with God in paradise.',
              source: 'https://www.britannica.com/topic/Christianity',
              atmosphere: 'atmosphere-heaven'
            },
            purgatory: {
              name: 'Christianity - Purgatory',
              description: 'Purification before entering heaven.',
              source: 'https://www.britannica.com/topic/purgatory',
              atmosphere: 'atmosphere-heaven'
            },
            hell: {
              name: 'Christianity - Hell',
              description: 'Separation from God; eternal suffering.',
              source: 'https://www.britannica.com/topic/hell-Christianity',
              atmosphere: 'atmosphere-hell'
            },
            jannah: {
              name: 'Islam - Jannah',
              description: 'Paradise; eternal bliss in the presence of Allah.',
              source: 'https://www.britannica.com/topic/Islam',
              atmosphere: 'atmosphere-jannah'
            },
            jahannam: {
              name: 'Islam - Jahannam',
              description: 'Hell; punishment for those who rejected faith.',
              source: 'https://www.britannica.com/topic/Islam',
              atmosphere: 'atmosphere-jahannam'
            },
            reincarnation: {
              name: 'Hinduism - Reincarnation',
              description: 'Soul reborn in a new body based on karma.',
              source: 'https://plato.stanford.edu/entries/hinduism/',
              atmosphere: 'atmosphere-hinduism'
            },
            moksha: {
              name: 'Hinduism - Moksha',
              description: 'Liberation from the cycle of rebirth; union with Brahman.',
              source: 'https://plato.stanford.edu/entries/hinduism/',
              atmosphere: 'atmosphere-hinduism'
            },
            judaism: {
              name: 'Judaism - Olam Ha-Ba',
              description: 'The World to Come; emphasis on legacy and remembrance.',
              source: 'https://www.myjewishlearning.com/article/olam-ha-ba-the-afterlife/',
              atmosphere: 'atmosphere-judaism'
            },
            ancestor: {
              name: 'Ancestor Traditions',
              description: 'Joining ancestors; continuing presence in the spiritual realm.',
              source: 'https://www.britannica.com/topic/ancestor-worship',
              atmosphere: 'atmosphere-ancestor'
            },
            idealism: {
              name: 'Analytic Idealism',
              description: 'Individual consciousness dissolves back into universal consciousness.',
              source: 'https://plato.stanford.edu/entries/idealism/',
              atmosphere: 'atmosphere-idealism'
            },
            panpsychism: {
              name: 'Panpsychism',
              description: 'Consciousness fragments and continues in all matter.',
              source: 'https://plato.stanford.edu/entries/panpsychism/',
              atmosphere: 'atmosphere-panpsychism'
            },
            illusionism: {
              name: 'Illusionism',
              description: 'Consciousness ceases; subjective experience ends completely.',
              source: 'https://plato.stanford.edu/entries/consciousness-illusionism/',
              atmosphere: 'atmosphere-illusionism'
            },
            simulation: {
              name: 'Simulation Theory',
              description: 'Process terminates or transitions to another level of simulation.',
              source: 'https://www.scientificamerican.com/article/do-we-live-in-a-simulation-chances-are-about-50-50/',
              atmosphere: 'atmosphere-simulation'
            },
            atomic: {
              name: 'Atomic Dispersal',
              description: 'Atoms scatter and recombine in new forms; carbon cycle continues.',
              source: 'https://www.scientificamerican.com/article/what-happens-to-atoms-after-death/',
              atmosphere: 'atmosphere-atomic'
            },
            heatdeath: {
              name: 'Heat Death',
              description: 'Energy dissipates toward universal entropy and stillness.',
              source: 'https://www.britannica.com/science/thermodynamics',
              atmosphere: 'atmosphere-heatdeath'
            }
          };

          useEffect(() => {
            const interval = setInterval(() => {
              setQuoteIndex((prev) => (prev + 1) % quotes.length);
            }, 8000);
            return () => clearInterval(interval);
          }, []);

          // Afterlife feature handlers
          const handleWhatComesAfter = () => {
            setShowAfterlife(true);
            setIsDeathSequence(true);

            // Death sequence: dim all future dots then show selector
            setTimeout(() => {
              setIsDeathSequence(false);
              setShowWorldviewSelector(true);
            }, 2000);
          };

          const handleWorldviewSelect = (worldviewKey) => {
            setSelectedWorldview(worldviewKey);
            setShowWorldviewSelector(false);
            setPageAtmosphere(worldviews[worldviewKey].atmosphere);
          };

          const handleReset = () => {
            setShowAfterlife(false);
            setIsDeathSequence(false);
            setShowWorldviewSelector(false);
            setSelectedWorldview(null);
            setPageAtmosphere('');
          };

          const handleCurrentAgeChange = (value) => {
            const age = Number(value);
            setCurrentAge(age);
            if (age >= goalAge) {
              setGoalAge(age + 1);
            }
          };

          const handleGoalAgeChange = (value) => {
            const age = Number(value);
            if (age > currentAge) {
              setGoalAge(age);
            }
          };

          // Calculate perceived time ratio for each year
          const getPerceivedTimeRatio = (age) => {
            // Using logarithmic perception: each year feels like 1/age of total life
            return 1 / age;
          };

          // Calculate total perceived time for normalization
          const getTotalPerceivedTime = () => {
            let total = 0;
            for (let age = 1; age <= goalAge; age++) {
              total += getPerceivedTimeRatio(age);
            }
            return total;
          };

          // Calculate dot size based on perceived time contribution
          // All dots together = 100%, each sized by its perceived time weight
          const getDotSize = (monthIndex) => {
            const yearAge = Math.floor(monthIndex / 12) + 1;
            if (yearAge === 0) return 2;

            // Each month in this year has 1/12th of that year's perceived time
            const monthPerceivedValue = getPerceivedTimeRatio(yearAge) / 12;
            const totalPerceivedTime = getTotalPerceivedTime();

            // Normalize to percentage of total perceived life
            const percentageOfLife = monthPerceivedValue / totalPerceivedTime;

            // Scale to reasonable pixel sizes (1-8px range)
            // Multiply by a factor to make dots visible
            const size = Math.max(1, Math.min(8, percentageOfLife * 3000));
            return size;
          };

          const calculateMetrics = () => {
            const totalMonths = goalAge * 12;
            const livedMonths = currentAge * 12;
            const remainingMonths = totalMonths - livedMonths;

            const daysRemaining = Math.floor(remainingMonths * 30.44);
            const weekendsRemaining = Math.floor(daysRemaining / 7); // One weekend per week
            const healthyYearsThreshold = 75;
            const healthyYearsRemaining = Math.max(0, healthyYearsThreshold - currentAge);
            const percentageLived = ((livedMonths / totalMonths) * 100).toFixed(1);

            // Calculate perceived time remaining
            let totalPerceivedTime = 0;
            let remainingPerceivedTime = 0;
            for (let age = 1; age <= goalAge; age++) {
              const perceived = getPerceivedTimeRatio(age);
              totalPerceivedTime += perceived;
              if (age > currentAge) {
                remainingPerceivedTime += perceived;
              }
            }
            const perceivedPercentageRemaining = ((remainingPerceivedTime / totalPerceivedTime) * 100).toFixed(1);

            return {
              totalMonths,
              livedMonths,
              remainingMonths,
              daysRemaining,
              weekendsRemaining,
              healthyYearsRemaining,
              percentageLived,
              perceivedPercentageRemaining
            };
          };

          const metrics = calculateMetrics();
          const currentQuote = quotes[quoteIndex];

          const getHealthColor = (monthIndex) => {
            const age = monthIndex / 12;

            if (age < 20) return 'bg-blue-300';
            if (age >= 20 && age < 40) return 'bg-green-300';
            if (age >= 40 && age < 60) return 'bg-yellow-300';
            if (age >= 60 && age < 75) return 'bg-orange-300';
            return 'bg-red-300';
          };

          const renderLifeGrid = () => {
            const squares = [];
            const currentMonth = Math.floor(currentAge * 12);

            for (let i = 0; i < metrics.totalMonths; i++) {
              const isPast = i < currentMonth;
              const isCurrent = i === currentMonth;
              const isFuture = i > currentMonth;
              const dotSize = getDotSize(i);
              const healthColor = getHealthColor(i);

              // Determine animation class based on worldview and afterlife state
              let animationClass = '';
              let animationStyle = {};

              if (showAfterlife && isFuture) {
                if (isDeathSequence) {
                  animationClass = 'animate-[die_0.5s_ease-out_forwards]';
                  animationStyle.animationDelay = `${(metrics.totalMonths - i) * 0.01}s`;
                } else if (selectedWorldview) {
                  // Apply worldview-specific transformations
                  switch (selectedWorldview) {
                    case 'buddhism':
                      animationClass = 'animate-[buddhist-dissolve_3s_ease-in-out_infinite]';
                      break;
                    case 'nirvana':
                      animationClass = 'animate-[nirvana-merge_4s_ease-out_forwards]';
                      break;
                    case 'heaven':
                      animationClass = 'animate-[rise-to-heaven_3s_ease-out_forwards]';
                      break;
                    case 'purgatory':
                      animationClass = 'animate-[purgatory-purify_2s_ease-in-out_infinite]';
                      break;
                    case 'hell':
                      animationClass = 'animate-[descend-to-hell_3s_ease-out_forwards]';
                      break;
                    case 'jannah':
                      animationClass = 'animate-[barzakh-pause_1s_ease-in_forwards,rise-to-jannah_3s_1s_ease-out_forwards]';
                      break;
                    case 'jahannam':
                      animationClass = 'animate-[barzakh-pause_1s_ease-in_forwards,descend-to-jahannam_3s_1s_ease-out_forwards]';
                      break;
                    case 'reincarnation':
                      animationClass = 'animate-[reincarnate-scatter_4s_ease-in-out_infinite]';
                      const scatterX = (Math.random() - 0.5) * 400;
                      const scatterY = (Math.random() - 0.5) * 400;
                      const rebornX = (Math.random() - 0.5) * 200;
                      const rebornY = (Math.random() - 0.5) * 200;
                      animationStyle = {
                        '--scatter-x': `${scatterX}px`,
                        '--scatter-y': `${scatterY}px`,
                        '--reborn-x': `${rebornX}px`,
                        '--reborn-y': `${rebornY}px`
                      };
                      break;
                    case 'moksha':
                      animationClass = 'animate-[moksha-expand_5s_ease-out_forwards]';
                      break;
                    case 'judaism':
                      animationClass = 'animate-[judaic-rest_2s_ease-out_forwards]';
                      break;
                    case 'ancestor':
                      animationClass = 'animate-[move-to-past_3s_ease-out_forwards]';
                      break;
                    case 'idealism':
                      animationClass = 'animate-[dissolve-boundaries_4s_ease-out_forwards]';
                      break;
                    case 'panpsychism':
                      animationClass = 'animate-[fragment-consciousness_3s_ease-out_forwards]';
                      const fragmentX = (Math.random() - 0.5) * 600;
                      const fragmentY = (Math.random() - 0.5) * 600;
                      animationStyle = {
                        '--fragment-x': `${fragmentX}px`,
                        '--fragment-y': `${fragmentY}px`
                      };
                      break;
                    case 'illusionism':
                      animationClass = 'animate-[switch-off_1s_ease-out_forwards]';
                      break;
                    case 'simulation':
                      animationClass = 'animate-[glitch_2s_ease-in-out_forwards]';
                      break;
                    case 'atomic':
                      animationClass = 'animate-[atomic-drift_5s_ease-out_forwards]';
                      const driftX = (Math.random() - 0.5) * 500;
                      const driftY = (Math.random() - 0.5) * 500;
                      const newColors = ['#10b981', '#3b82f6', '#78350f'];
                      animationStyle = {
                        '--drift-x': `${driftX}px`,
                        '--drift-y': `${driftY}px`,
                        backgroundColor: newColors[Math.floor(Math.random() * newColors.length)]
                      };
                      break;
                    case 'heatdeath':
                      animationClass = 'animate-[heat-death_8s_ease-out_forwards]';
                      break;
                  }
                }
              }

              // NOW dot specific styling
              const nowDotClass = isCurrent && !showAfterlife ? 'pulse-now' : '';
              const nowDotScale = isCurrent && !showAfterlife ? 1.5 : 1;

              // Final pulse for NOW dot during death sequence
              if (isCurrent && isDeathSequence) {
                animationClass = 'animate-[final-pulse_1s_ease-in-out_3,die_0.5s_3s_ease-out_forwards]';
              }

              // Future dots get a glow effect to represent remaining perceived time
              const glowClass = !isPast && !isCurrent && !showAfterlife ? 'shadow-md' : '';

              squares.push(
                <div
                  key={i}
                  className={`transition-all duration-300 rounded-sm ${glowClass} ${nowDotClass} ${animationClass} ${
                    isCurrent && !showAfterlife
                      ? 'bg-green-400 shadow-lg shadow-green-400/50'
                      : isPast || (showAfterlife && isFuture && !selectedWorldview)
                      ? 'bg-gray-600/60'
                      : `${healthColor} shadow-${healthColor.replace('bg-', '')}/50`
                  }`}
                  style={{
                    width: `${dotSize * 2 * nowDotScale}px`,
                    height: `${dotSize * 2 * nowDotScale}px`,
                    ...animationStyle
                  }}
                  title={`Month ${i + 1} - Age ${Math.floor(i / 12)} - Perceived contribution: ${(dotSize / 8 * 100).toFixed(2)}%`}
                />
              );
            }
            return squares;
          };

          return (
            <div className={`min-h-screen transition-all duration-1000 text-gray-100 p-8 ${pageAtmosphere || 'bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900'}`}>
              <div className="max-w-7xl mx-auto space-y-12">
                {/* Header */}
                <header className="text-center space-y-4">
                  <h1 className="text-5xl font-extralight tracking-wider text-gray-100">
                    The Perspective Engine
                  </h1>
                  <p className="text-gray-400 text-lg font-light max-w-2xl mx-auto">
                    A visual meditation on time, presence, and making it count
                  </p>
                  <nav className="pt-4">
                    <a href="/" className="text-green-400 hover:text-green-300 transition-colors" data-track="Back to Projects">
                      ← Back to Projects
                    </a>
                  </nav>
                </header>

                {/* Gentle Warning/Framing */}
                <div className="bg-amber-900/10 backdrop-blur-sm rounded-xl p-6 border border-amber-700/20 max-w-3xl mx-auto">
                  <div className="flex items-start gap-3">
                    <div className="text-amber-400/70 mt-1">⚡</div>
                    <div className="space-y-2 text-gray-300 font-light leading-relaxed text-sm">
                      <p className="font-medium text-amber-300/90">A note before you scroll:</p>
                      <p>
                        This tool visualizes theories about time perception that can feel confronting.
                        It's meant to inspire presence, not despair. Take what resonates, leave what doesn't—and
                        maybe don't operate heavy machinery while contemplating mortality.
                      </p>
                    </div>
                  </div>
                </div>

                {/* Input Section with Sliders */}
                <div className="bg-gray-800/30 backdrop-blur-sm rounded-2xl p-8 border border-gray-700/50 shadow-2xl">
                  <div className="grid md:grid-cols-2 gap-12 max-w-3xl mx-auto">
                    <div className="space-y-4">
                      <div className="flex justify-between items-center">
                        <label className="block text-sm font-light text-gray-300 tracking-wide">
                          Current Age
                        </label>
                        <span className="text-3xl font-extralight text-green-400">{currentAge}</span>
                      </div>
                      <input
                        type="range"
                        value={currentAge}
                        onChange={(e) => handleCurrentAgeChange(e.target.value)}
                        className="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-green-400"
                        min="1"
                        max="119"
                        step="1"
                        data-track="Adjust Current Age"
                      />
                      <div className="flex justify-between text-xs text-gray-500">
                        <span>1</span>
                        <span>119</span>
                      </div>
                    </div>
                    <div className="space-y-4">
                      <div className="flex justify-between items-center">
                        <label className="block text-sm font-light text-gray-300 tracking-wide">
                          Goal Age
                        </label>
                        <span className="text-3xl font-extralight text-blue-400">{goalAge}</span>
                      </div>
                      <input
                        type="range"
                        value={goalAge}
                        onChange={(e) => handleGoalAgeChange(e.target.value)}
                        className="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-400"
                        min={currentAge + 1}
                        max="120"
                        step="1"
                        data-track="Adjust Goal Age"
                      />
                      <div className="flex justify-between text-xs text-gray-500">
                        <span>{currentAge + 1}</span>
                        <span>120</span>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Metrics Dashboard */}
                <div className="grid md:grid-cols-5 gap-6">
                  <div className="bg-gray-800/30 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 space-y-3">
                    <div className="flex items-center gap-3 text-gray-400">
                      <ClockIcon />
                      <span className="text-sm font-light tracking-wide">Days Left</span>
                    </div>
                    <p className="text-4xl font-extralight text-gray-100">
                      {metrics.daysRemaining.toLocaleString()}
                    </p>
                  </div>

                  <div className="bg-gray-800/30 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 space-y-3">
                    <div className="flex items-center gap-3 text-gray-400">
                      <CalendarIcon />
                      <span className="text-sm font-light tracking-wide">Weekends</span>
                    </div>
                    <p className="text-4xl font-extralight text-gray-100">
                      {metrics.weekendsRemaining.toLocaleString()}
                    </p>
                  </div>

                  <div className="bg-gray-800/30 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 space-y-3">
                    <div className="flex items-center gap-3 text-gray-400">
                      <HeartIcon />
                      <span className="text-sm font-light tracking-wide">Healthy Years</span>
                    </div>
                    <p className="text-4xl font-extralight text-gray-100">
                      {metrics.healthyYearsRemaining}
                    </p>
                  </div>

                  <div className="bg-gray-800/30 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 space-y-3">
                    <div className="flex items-center gap-3 text-gray-400">
                      <TrendingUpIcon />
                      <span className="text-sm font-light tracking-wide">Life Lived</span>
                    </div>
                    <p className="text-4xl font-extralight text-gray-100">
                      {metrics.percentageLived}%
                    </p>
                  </div>

                  <div className="bg-gradient-to-br from-purple-900/20 to-purple-800/10 backdrop-blur-sm rounded-2xl p-6 border border-purple-700/30 space-y-3">
                    <div className="flex items-center gap-2 text-purple-300">
                      <ZapIcon />
                      <span className="text-sm font-light tracking-wide">Perceived Time (One Theory)</span>
                      <div
                        className="cursor-help text-purple-400/60 hover:text-purple-300 transition-colors"
                        title="Based on the proportional theory—one model of time perception. Your actual experience may vary based on novelty, presence, and how you live."
                      >
                        <InfoIcon />
                      </div>
                    </div>
                    <p className="text-4xl font-extralight text-purple-200">
                      {metrics.perceivedPercentageRemaining}%
                    </p>
                  </div>
                </div>

                {/* Perception Explanation */}
                <div className="bg-gradient-to-br from-purple-900/20 to-purple-800/10 backdrop-blur-sm rounded-2xl p-8 border border-purple-700/30">
                  <div className="flex items-start gap-4">
                    <ZapIcon />
                    <div className="space-y-3">
                      <h3 className="text-xl font-light text-purple-200">Perceptual Time Theory</h3>
                      <p className="text-gray-300 font-light leading-relaxed">
                        Notice how the dots grow smaller as you age? This visualizes the <strong>Proportional Theory</strong>:
                        at age 5, one year is 20% of your entire life. At 50, it's just 2%. Your brain encodes less novelty
                        as routines form, and neural processing slows—making time feel like it's accelerating. The perceived
                        time metric above offers <em>one model</em> of how much felt experience might remain—though your
                        mileage may vary. Novelty, presence, and intentional living can stretch time back out.
                      </p>
                    </div>
                  </div>
                </div>

                {/* Progress Bars */}
                <div className="grid md:grid-cols-2 gap-6">
                  <div className="bg-gray-800/30 backdrop-blur-sm rounded-2xl p-8 border border-gray-700/50">
                    <div className="space-y-4">
                      <h3 className="text-lg font-light text-gray-300">Calendar Time</h3>
                      <div className="flex justify-between text-sm text-gray-400 font-light">
                        <span>Birth</span>
                        <span className="text-green-400">Now</span>
                        <span>Age {goalAge}</span>
                      </div>
                      <div className="h-3 bg-gray-700/60 rounded-full overflow-hidden">
                        <div
                          className="h-full bg-gradient-to-r from-gray-600 to-green-400 transition-all duration-1000"
                          style={{ width: `${metrics.percentageLived}%` }}
                        />
                      </div>
                    </div>
                  </div>

                  <div className="bg-purple-900/20 backdrop-blur-sm rounded-2xl p-8 border border-purple-700/30">
                    <div className="space-y-4">
                      <h3 className="text-lg font-light text-purple-200">Perceived Time</h3>
                      <div className="flex justify-between text-sm text-purple-300 font-light">
                        <span>Birth</span>
                        <span className="text-purple-400">Now</span>
                        <span>Age {goalAge}</span>
                      </div>
                      <div className="h-3 bg-purple-800/60 rounded-full overflow-hidden">
                        <div
                          className="h-full bg-gradient-to-r from-purple-600 to-purple-400 transition-all duration-1000"
                          style={{ width: `${100 - parseFloat(metrics.perceivedPercentageRemaining)}%` }}
                        />
                      </div>
                    </div>
                  </div>
                </div>

                {/* Life Grid */}
                <div className="bg-gray-800/30 backdrop-blur-sm rounded-2xl p-8 border border-gray-700/50">
                  <h2 className="text-2xl font-extralight text-gray-100 mb-6 text-center">
                    Your Life in Months (Scaled by Perceived Time)
                  </h2>
                  <div className="flex flex-wrap gap-1 justify-center max-w-5xl mx-auto items-end">
                    {renderLifeGrid()}
                  </div>
                  <div className="flex justify-center gap-6 mt-8 text-sm text-gray-400 font-light flex-wrap">
                    <div className="flex items-center gap-2">
                      <div className="w-3 h-3 bg-gray-500/70" />
                      <span>Past</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-3 h-3 bg-green-400 shadow-lg shadow-green-400/50" />
                      <span>Current</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-3 h-3 bg-blue-300" />
                      <span>Youth (0-20)</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-3 h-3 bg-green-300" />
                      <span>Peak (20-40)</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-3 h-3 bg-yellow-300" />
                      <span>Prime (40-60)</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-3 h-3 bg-orange-300" />
                      <span>Mature (60-75)</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-3 h-3 bg-red-300" />
                      <span>Elder (75+)</span>
                    </div>
                  </div>

                  {/* What Comes After Button */}
                  {!showAfterlife && (
                    <div className="flex justify-center mt-8">
                      <button
                        onClick={handleWhatComesAfter}
                        className="px-6 py-3 bg-gray-700/50 hover:bg-gray-600/50 text-gray-300 hover:text-gray-100 rounded-lg border border-gray-600/50 hover:border-gray-500/70 transition-all duration-300 font-light tracking-wide text-sm"
                        data-track="What Comes After Button"
                      >
                        What Comes After
                      </button>
                    </div>
                  )}

                  {/* Reset Button */}
                  {selectedWorldview && (
                    <div className="flex justify-center mt-8">
                      <button
                        onClick={handleReset}
                        className="px-6 py-3 bg-green-700/50 hover:bg-green-600/50 text-green-300 hover:text-green-100 rounded-lg border border-green-600/50 hover:border-green-500/70 transition-all duration-300 font-light tracking-wide text-sm"
                        data-track="Reset to Life Button"
                      >
                        Return to Life
                      </button>
                    </div>
                  )}
                </div>

                {/* Worldview Selector Modal */}
                {showWorldviewSelector && (
                  <div className="modal-backdrop" onClick={() => setShowWorldviewSelector(false)}>
                    <div className="modal-content bg-gray-800/95 backdrop-blur-md rounded-2xl p-8 border border-gray-700/70 max-w-4xl mx-4" onClick={(e) => e.stopPropagation()}>
                      <h2 className="text-3xl font-extralight text-gray-100 mb-6 text-center">What Comes After</h2>
                      <p className="text-gray-400 text-center mb-8 font-light">
                        Different worldviews offer different answers. Choose one to explore:
                      </p>

                      <div className="space-y-6">
                        {/* Traditional Religions */}
                        <div>
                          <h3 className="text-lg font-light text-gray-300 mb-3 flex items-center gap-2">
                            Traditional Religions
                          </h3>
                          <div className="grid md:grid-cols-2 gap-3">
                            <button
                              onClick={() => handleWorldviewSelect('buddhism')}
                              className="p-4 bg-gray-700/50 hover:bg-blue-900/30 rounded-lg border border-gray-600/50 hover:border-blue-500/50 transition-all text-left"
                              data-track="Select Buddhism Rebirth"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Buddhism - Rebirth</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.buddhism.description}</div>
                                </div>
                                <a href={worldviews.buddhism.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('nirvana')}
                              className="p-4 bg-gray-700/50 hover:bg-blue-900/30 rounded-lg border border-gray-600/50 hover:border-blue-500/50 transition-all text-left"
                              data-track="Select Buddhism Nirvana"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Buddhism - Nirvana</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.nirvana.description}</div>
                                </div>
                                <a href={worldviews.nirvana.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('heaven')}
                              className="p-4 bg-gray-700/50 hover:bg-yellow-900/30 rounded-lg border border-gray-600/50 hover:border-yellow-500/50 transition-all text-left"
                              data-track="Select Christianity Heaven"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Christianity - Heaven</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.heaven.description}</div>
                                </div>
                                <a href={worldviews.heaven.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('purgatory')}
                              className="p-4 bg-gray-700/50 hover:bg-yellow-900/30 rounded-lg border border-gray-600/50 hover:border-yellow-500/50 transition-all text-left"
                              data-track="Select Christianity Purgatory"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Christianity - Purgatory</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.purgatory.description}</div>
                                </div>
                                <a href={worldviews.purgatory.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('hell')}
                              className="p-4 bg-gray-700/50 hover:bg-red-900/30 rounded-lg border border-gray-600/50 hover:border-red-500/50 transition-all text-left"
                              data-track="Select Christianity Hell"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Christianity - Hell</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.hell.description}</div>
                                </div>
                                <a href={worldviews.hell.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('jannah')}
                              className="p-4 bg-gray-700/50 hover:bg-green-900/30 rounded-lg border border-gray-600/50 hover:border-green-500/50 transition-all text-left"
                              data-track="Select Islam Jannah"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Islam - Jannah</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.jannah.description}</div>
                                </div>
                                <a href={worldviews.jannah.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('jahannam')}
                              className="p-4 bg-gray-700/50 hover:bg-red-900/30 rounded-lg border border-gray-600/50 hover:border-red-500/50 transition-all text-left"
                              data-track="Select Islam Jahannam"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Islam - Jahannam</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.jahannam.description}</div>
                                </div>
                                <a href={worldviews.jahannam.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('reincarnation')}
                              className="p-4 bg-gray-700/50 hover:bg-orange-900/30 rounded-lg border border-gray-600/50 hover:border-orange-500/50 transition-all text-left"
                              data-track="Select Hinduism Reincarnation"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Hinduism - Reincarnation</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.reincarnation.description}</div>
                                </div>
                                <a href={worldviews.reincarnation.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('moksha')}
                              className="p-4 bg-gray-700/50 hover:bg-orange-900/30 rounded-lg border border-gray-600/50 hover:border-orange-500/50 transition-all text-left"
                              data-track="Select Hinduism Moksha"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Hinduism - Moksha</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.moksha.description}</div>
                                </div>
                                <a href={worldviews.moksha.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('judaism')}
                              className="p-4 bg-gray-700/50 hover:bg-yellow-900/30 rounded-lg border border-gray-600/50 hover:border-yellow-500/50 transition-all text-left"
                              data-track="Select Judaism"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Judaism - Olam Ha-Ba</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.judaism.description}</div>
                                </div>
                                <a href={worldviews.judaism.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('ancestor')}
                              className="p-4 bg-gray-700/50 hover:bg-stone-900/30 rounded-lg border border-gray-600/50 hover:border-stone-500/50 transition-all text-left"
                              data-track="Select Ancestor Traditions"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Ancestor Traditions</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.ancestor.description}</div>
                                </div>
                                <a href={worldviews.ancestor.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>
                          </div>
                        </div>

                        {/* Philosophical Frameworks */}
                        <div>
                          <h3 className="text-lg font-light text-gray-300 mb-3">Philosophical Frameworks</h3>
                          <div className="grid md:grid-cols-2 gap-3">
                            <button
                              onClick={() => handleWorldviewSelect('idealism')}
                              className="p-4 bg-gray-700/50 hover:bg-purple-900/30 rounded-lg border border-gray-600/50 hover:border-purple-500/50 transition-all text-left"
                              data-track="Select Analytic Idealism"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Analytic Idealism</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.idealism.description}</div>
                                </div>
                                <a href={worldviews.idealism.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('panpsychism')}
                              className="p-4 bg-gray-700/50 hover:bg-blue-900/30 rounded-lg border border-gray-600/50 hover:border-blue-500/50 transition-all text-left"
                              data-track="Select Panpsychism"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Panpsychism</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.panpsychism.description}</div>
                                </div>
                                <a href={worldviews.panpsychism.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('illusionism')}
                              className="p-4 bg-gray-700/50 hover:bg-gray-600/30 rounded-lg border border-gray-600/50 hover:border-gray-500/50 transition-all text-left"
                              data-track="Select Illusionism"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Illusionism</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.illusionism.description}</div>
                                </div>
                                <a href={worldviews.illusionism.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('simulation')}
                              className="p-4 bg-gray-700/50 hover:bg-cyan-900/30 rounded-lg border border-gray-600/50 hover:border-cyan-500/50 transition-all text-left"
                              data-track="Select Simulation Theory"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Simulation Theory</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.simulation.description}</div>
                                </div>
                                <a href={worldviews.simulation.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>
                          </div>
                        </div>

                        {/* Materialist / Scientific */}
                        <div>
                          <h3 className="text-lg font-light text-gray-300 mb-3">Materialist / Scientific</h3>
                          <div className="grid md:grid-cols-2 gap-3">
                            <button
                              onClick={() => handleWorldviewSelect('atomic')}
                              className="p-4 bg-gray-700/50 hover:bg-green-900/30 rounded-lg border border-gray-600/50 hover:border-green-500/50 transition-all text-left"
                              data-track="Select Atomic Dispersal"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Atomic Dispersal</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.atomic.description}</div>
                                </div>
                                <a href={worldviews.atomic.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>

                            <button
                              onClick={() => handleWorldviewSelect('heatdeath')}
                              className="p-4 bg-gray-700/50 hover:bg-slate-900/30 rounded-lg border border-gray-600/50 hover:border-slate-500/50 transition-all text-left"
                              data-track="Select Heat Death"
                            >
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="font-medium text-gray-200">Heat Death</div>
                                  <div className="text-sm text-gray-400 mt-1">{worldviews.heatdeath.description}</div>
                                </div>
                                <a href={worldviews.heatdeath.source} target="_blank" rel="noopener noreferrer" onClick={(e) => e.stopPropagation()} className="text-gray-500 hover:text-gray-300 ml-2">
                                  <InfoIcon />
                                </a>
                              </div>
                            </button>
                          </div>
                        </div>
                      </div>

                      <div className="mt-8 text-center">
                        <button
                          onClick={() => setShowWorldviewSelector(false)}
                          className="px-6 py-2 bg-gray-700/50 hover:bg-gray-600/50 text-gray-300 hover:text-gray-100 rounded-lg border border-gray-600/50 hover:border-gray-500/70 transition-all"
                        >
                          Close
                        </button>
                      </div>
                    </div>
                  </div>
                )}

                {/* Reclaim Your Time - Hope Section */}
                <div className="bg-gradient-to-br from-green-900/15 to-emerald-900/10 backdrop-blur-sm rounded-2xl p-8 border border-green-700/30">
                  <div className="flex items-start gap-4 max-w-4xl mx-auto">
                    <div className="text-green-400 mt-1">
                      <SproutIcon />
                    </div>
                    <div className="space-y-4">
                      <h3 className="text-2xl font-light text-green-200">The Good News: Time Expands With Presence</h3>
                      <p className="text-gray-300 font-light leading-relaxed">
                        The science of time perception suggests you can push back against acceleration. While routines
                        and comfort tend to compress our experience of time, you have agency in how time feels:
                      </p>
                      <ul className="space-y-3 text-gray-300 font-light leading-relaxed">
                        <li className="flex gap-3">
                          <span className="text-green-400 mt-1">•</span>
                          <div>
                            <strong className="text-green-300">Seek novelty:</strong> New experiences create richer memories,
                            making time feel longer in retrospect. Travel, learn new skills, break your routines.
                          </div>
                        </li>
                        <li className="flex gap-3">
                          <span className="text-green-400 mt-1">•</span>
                          <div>
                            <strong className="text-green-300">Practice presence:</strong> Mindfulness and attention to the
                            current moment expand subjective time. The opposite of "where did the day go?"
                          </div>
                        </li>
                        <li className="flex gap-3">
                          <span className="text-green-400 mt-1">•</span>
                          <div>
                            <strong className="text-green-300">Create milestones:</strong> Memorable events anchor time.
                            A year with distinct chapters feels longer than one undifferentiated blur.
                          </div>
                        </li>
                        <li className="flex gap-3">
                          <span className="text-green-400 mt-1">•</span>
                          <div>
                            <strong className="text-green-300">Embrace discomfort:</strong> Growth and challenge stretch
                            time. Comfort and routine compress it.
                          </div>
                        </li>
                      </ul>
                      <p className="text-gray-400 font-light italic text-sm pt-2">
                        Your perception of time isn't fixed—it's shaped by how intentionally you live.
                      </p>
                    </div>
                  </div>
                </div>

                {/* Quote Section */}
                <div className="bg-gradient-to-br from-gray-800/40 to-gray-800/20 backdrop-blur-sm rounded-2xl p-12 border border-gray-700/50">
                  <blockquote className="space-y-6 text-center max-w-3xl mx-auto">
                    <p className="text-2xl font-light text-gray-200 leading-relaxed transition-all duration-500">
                      "{currentQuote.text}"
                    </p>
                    <footer className="text-gray-400 text-lg font-light">
                      — {currentQuote.author}
                    </footer>
                  </blockquote>
                </div>

                {/* Sources / Learn More */}
                <div className="bg-gray-800/20 backdrop-blur-sm rounded-xl p-6 border border-gray-700/30 max-w-3xl mx-auto">
                  <h4 className="text-sm font-medium text-gray-400 mb-3 tracking-wide">Further Reading</h4>
                  <div className="space-y-2 text-xs text-gray-500 font-light">
                    <p>
                      <a
                        href="https://www.amazon.com/Why-Time-Flies-Mostly-Scientific/dp/1416540288"
                        target="_blank"
                        rel="noopener noreferrer"
                        className="text-gray-400 hover:text-green-400 transition-colors underline decoration-dotted"
                      >
                        Why Time Flies
                      </a>
                      {' '}by Alan Burdick — A beautifully written exploration of time perception
                    </p>
                    <p>
                      <a
                        href="https://en.wikipedia.org/wiki/Time_perception#Changes_with_age"
                        target="_blank"
                        rel="noopener noreferrer"
                        className="text-gray-400 hover:text-green-400 transition-colors underline decoration-dotted"
                      >
                        The Proportional Theory
                      </a>
                      {' '}— Wikipedia on time perception and aging
                    </p>
                    <p>
                      <a
                        href="https://pubmed.ncbi.nlm.nih.gov/23643368/"
                        target="_blank"
                        rel="noopener noreferrer"
                        className="text-gray-400 hover:text-green-400 transition-colors underline decoration-dotted"
                      >
                        Mindfulness and Time Perception
                      </a>
                      {' '}— Research on how mindfulness expands subjective time
                    </p>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<PerspectiveEngine />);
    </script>
</body>
</html>
