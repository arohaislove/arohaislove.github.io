<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Google Apps Script Setup Helper</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #1a1a2e;
            color: #e0e0e0;
            padding: 20px;
            font-size: 18px;
            line-height: 1.6;
        }
        h1 {
            font-size: 24px;
            margin-bottom: 16px;
            color: #fff;
        }
        h2 {
            font-size: 20px;
            margin: 24px 0 12px;
            color: #7fdbca;
        }
        .step {
            background: #16213e;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            border-left: 4px solid #7fdbca;
        }
        .step-number {
            display: inline-block;
            background: #7fdbca;
            color: #1a1a2e;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            text-align: center;
            line-height: 32px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        .script-box {
            background: #0a0a1a;
            border: 2px solid #7fdbca;
            border-radius: 12px;
            padding: 16px;
            margin: 12px 0;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.5;
            word-break: break-all;
            white-space: pre-wrap;
            color: #c3e88d;
            -webkit-user-select: all;
            user-select: all;
        }
        .copy-btn {
            display: block;
            width: 100%;
            padding: 18px;
            font-size: 20px;
            font-weight: bold;
            background: #7fdbca;
            color: #1a1a2e;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            margin: 12px 0;
            -webkit-tap-highlight-color: transparent;
        }
        .copy-btn:active {
            background: #5fb8a5;
            transform: scale(0.98);
        }
        .copy-btn.copied {
            background: #c3e88d;
        }
        .warning {
            background: #2d1b00;
            border: 2px solid #ffcb6b;
            border-radius: 12px;
            padding: 16px;
            margin: 12px 0;
            color: #ffcb6b;
        }
        .back-link {
            display: inline-block;
            color: #7fdbca;
            margin-bottom: 16px;
            text-decoration: none;
        }
        p { margin-bottom: 8px; }
        strong { color: #fff; }
    </style>
</head>
<body>
    <a href="/" class="back-link">&larr; Back to Projects</a>
    <h1>Google Sheets Setup Helper</h1>
    <p>Follow these steps on your phone to connect Google Sheets.</p>

    <h2>The Script</h2>
    <p>Tap the button below to copy, then paste it into Apps Script.</p>

    <div class="script-box" id="script-text">function doGet() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = sheet.getDataRange().getValues();
  return ContentService
    .createTextOutput(JSON.stringify(data))
    .setMimeType(ContentService.MimeType.JSON);
}</div>

    <button class="copy-btn" id="copy-btn" onclick="copyScript()">
        TAP TO COPY SCRIPT
    </button>

    <h2>Steps</h2>

    <div class="step">
        <div class="step-number">1</div>
        <p>Open your Google Sheet</p>
    </div>

    <div class="step">
        <div class="step-number">2</div>
        <p>Tap <strong>Extensions</strong> menu &rarr; <strong>Apps Script</strong></p>
    </div>

    <div class="step">
        <div class="step-number">3</div>
        <p><strong>Select all</strong> existing code in the editor and <strong>delete</strong> it</p>
    </div>

    <div class="step">
        <div class="step-number">4</div>
        <p><strong>Paste</strong> the script you copied above</p>
    </div>

    <div class="step">
        <div class="step-number">5</div>
        <p>Tap <strong>Deploy</strong> &rarr; <strong>New deployment</strong></p>
    </div>

    <div class="step">
        <div class="step-number">6</div>
        <p>Set type to <strong>Web app</strong></p>
        <p>Set "Who has access" to <strong>Anyone</strong></p>
        <p>Tap <strong>Deploy</strong></p>
    </div>

    <div class="step">
        <div class="step-number">7</div>
        <p><strong>Authorize</strong> when prompted (tap Advanced &rarr; Go to Untitled project)</p>
    </div>

    <div class="step">
        <div class="step-number">8</div>
        <p><strong>Copy the Web app URL</strong> it gives you and send it back to Claude!</p>
    </div>

    <div class="warning">
        <strong>The URL will look like:</strong><br>
        https://script.google.com/macros/s/ABC...XYZ/exec
    </div>

    <script>
        function copyScript() {
            var text = document.getElementById('script-text').textContent;
            var btn = document.getElementById('copy-btn');

            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(function() {
                    btn.textContent = 'COPIED!';
                    btn.classList.add('copied');
                    setTimeout(function() {
                        btn.textContent = 'TAP TO COPY SCRIPT';
                        btn.classList.remove('copied');
                    }, 3000);
                }).catch(fallbackCopy);
            } else {
                fallbackCopy();
            }
        }

        function fallbackCopy() {
            var text = document.getElementById('script-text').textContent;
            var textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.left = '-9999px';
            textarea.style.fontSize = '16px'; // prevent iOS zoom
            document.body.appendChild(textarea);
            textarea.focus();
            textarea.select();

            try {
                document.execCommand('copy');
                var btn = document.getElementById('copy-btn');
                btn.textContent = 'COPIED!';
                btn.classList.add('copied');
                setTimeout(function() {
                    btn.textContent = 'TAP TO COPY SCRIPT';
                    btn.classList.remove('copied');
                }, 3000);
            } catch (e) {
                alert('Long-press the green script text above to select and copy it manually.');
            }

            document.body.removeChild(textarea);
        }
    </script>
</body>
</html>
